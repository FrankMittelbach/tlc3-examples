%%
%% The LaTeX Companion, 3ed
%%
%% Example 7-3-5 on page I-533 in "Captions for nonfloating figures and tables".
%%
%% Copyright (C) 2022 Frank Mittelbach
%%
%% It may be distributed and/or modified under the conditions
%% of the LaTeX Project Public License, either version 1.3c
%% of this license or (at your option) any later version.
%%
%% See https://www.latex-project.org/lppl.txt for details.
%%

\documentclass{tlc3exa}
\pagestyle{empty}
\setcounter{page}{6}
\setlength\textwidth{195.0pt}
\setcounter{page}{1}
\setlength\textheight{18\baselineskip}
% for the book examples we shorten the
% vertical spaces and use a smaller font for
% the heading
\makeatletter
\renewcommand\section{\@startsection{section}{1}{\z@}%
                                    {-1.25ex \@plus-1ex \@minus-.2ex}%
                                    {.5ex}%
                                    {\normalfont\large\bfseries}}
\makeatother

%StartShownPreambleCommands
 \usepackage{caption}
%StopShownPreambleCommands

\begin{document}
 \listoffigures
 \section{Various kinds of figures}
 Here we mix standard and nonfloating
 figures.
 \begin{figure}[b]  \centering
  \fbox{Figure A}
  \caption{Standard figure}\label{fig:a}
 \end{figure}
 \begin{center}
  \fbox{Figure B}
  \captionof{figure}[Wrong order]
                    {Nonfloating figure}
  \label{fig:b}
 \end{center}
 Because Figure \ref{fig:a} is forced to
 the bottom with an optional \texttt{[b]}
 argument it passes Figure \ref{fig:b}
 and the ordering in LOF gets out of sync.
\end{document}
